<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="é­”æ³•28å¤©æ„Ÿæ©ç·´ç¿’ - åŸºæ–¼æœ—é”Â·æ‹œæ©ã€Šé­”æ³•ã€‹ä¸€æ›¸çš„æ„Ÿæ©ç·´ç¿’æ‡‰ç”¨">
    <meta name="theme-color" content="#9d4edd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="é­”æ³•28å¤©">

    <title>é­”æ³•28å¤© âœ¨ æ„Ÿæ©ç·´ç¿’</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg">
    <link rel="apple-touch-icon" href="icons/icon-192.svg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="magic-bg">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="stars3"></div>
    </div>

    <div class="app-container">
        <!-- é¦–é  -->
        <section id="home" class="page active">
            <div class="hero">
                <div class="magic-circle">
                    <span class="magic-symbol">âœ¨</span>
                </div>
                <h1>é­”æ³•28å¤©</h1>
                <p class="subtitle">æ„Ÿæ©ç·´ç¿’ä¹‹æ—…</p>
                <p class="quote">"ç•¶ä½ å°æ“æœ‰çš„ä¸€åˆ‡å¿ƒå­˜æ„Ÿæ¿€ï¼Œä½ æœƒå¸å¼•æ›´å¤šç¾å¥½çš„äº‹ç‰©ã€‚"</p>
                <p class="author">â€” æœ—é”Â·æ‹œæ©ã€Šé­”æ³•ã€‹</p>

                <div class="progress-ring-container">
                    <svg class="progress-ring" width="120" height="120">
                        <circle class="progress-ring-bg" cx="60" cy="60" r="52" />
                        <circle class="progress-ring-circle" cx="60" cy="60" r="52" />
                    </svg>
                    <div class="progress-text">
                        <span id="current-day">1</span>
                        <span class="day-label">/ 28å¤©</span>
                    </div>
                </div>

                <button id="start-btn" class="primary-btn">
                    <span>é–‹å§‹ä»Šæ—¥ç·´ç¿’</span>
                    <span class="btn-sparkle">âœ¨</span>
                </button>

                <button id="view-all-btn" class="secondary-btn">
                    æŸ¥çœ‹æ‰€æœ‰ç·´ç¿’
                </button>
            </div>
        </section>

        <!-- ä»Šæ—¥ç·´ç¿’é  -->
        <section id="practice" class="page">
            <header class="page-header practice-header">
                <button class="back-btn" data-target="home">â† è¿”å›</button>
                <h2 id="practice-day-title">ç¬¬1å¤©</h2>
                <div class="day-nav-buttons">
                    <button id="prev-day-btn" class="day-nav-btn" title="ä¸Šä¸€å¤©">â—€</button>
                    <button id="next-day-btn" class="day-nav-btn" title="ä¸‹ä¸€å¤©">â–¶</button>
                </div>
            </header>

            <div class="practice-content">
                <div class="practice-card">
                    <div class="practice-badge">
                        <span id="practice-icon">ğŸŒŸ</span>
                    </div>
                    <h3 id="practice-title">æ•¸ç®—ä½ çš„æ©å…¸</h3>
                    <div id="practice-description" class="practice-description">
                        <!-- ç·´ç¿’èªªæ˜æœƒå‹•æ…‹è¼‰å…¥ -->
                    </div>
                </div>

                <!-- æ™¨é–“æ„Ÿæ©æ¸…å–® -->
                <div class="gratitude-section" id="morning-section">
                    <h4>ğŸŒ… æ™¨é–“æ„Ÿæ©æ¸…å–®</h4>
                    <p class="section-tip">å¯«ä¸‹ç”Ÿå‘½ä¸­è®“ä½ æ„Ÿæ©çš„åä»¶äº‹</p>
                    <div class="gratitude-list" id="morning-list">
                        <!-- å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    <button id="save-morning-btn" class="save-btn">
                        ğŸ’¾ å„²å­˜æ„Ÿæ©æ¸…å–®
                    </button>
                </div>

                <!-- ç•¶æ—¥ç‰¹å®šç·´ç¿’ -->
                <div class="daily-practice-section" id="daily-practice-section">
                    <h4>ğŸ“ ä»Šæ—¥ç·´ç¿’</h4>
                    <div id="daily-practice-content">
                        <!-- å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ™šé–“é­”æ³•çŸ³ -->
                <div class="magic-stone-section" id="stone-section">
                    <h4>ğŸŒ™ æ™šé–“é­”æ³•çŸ³ç·´ç¿’</h4>
                    <div class="stone-container">
                        <div class="magic-stone" id="magic-stone">
                            <span>ğŸª¨</span>
                        </div>
                        <p>æ¡è‘—ä½ çš„é­”æ³•çŸ³ï¼Œæƒ³æƒ³ä»Šå¤©æœ€ç¾å¥½çš„ä¸€ä»¶äº‹</p>
                    </div>
                    <textarea id="best-thing" placeholder="ä»Šå¤©æœ€ç¾å¥½çš„ä¸€ä»¶äº‹æ˜¯..."></textarea>
                    <button id="complete-day-btn" class="primary-btn complete-btn">
                        âœ¨ å®Œæˆä»Šæ—¥ç·´ç¿’
                    </button>
                </div>
            </div>
        </section>

        <!-- æ‰€æœ‰ç·´ç¿’ç¸½è¦½é  -->
        <section id="all-practices" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">â† è¿”å›</button>
                <h2>28å¤©ç·´ç¿’ç¸½è¦½</h2>
            </header>

            <div class="practices-grid" id="practices-grid">
                <!-- å‹•æ…‹ç”Ÿæˆ28å¤©ç·´ç¿’å¡ç‰‡ -->
            </div>
        </section>

        <!-- æ„Ÿæ©æ—¥è¨˜é  -->
        <section id="journal" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">â† è¿”å›</button>
                <h2>ğŸ“– æ„Ÿæ©æ—¥è¨˜</h2>
            </header>

            <div class="journal-content" id="journal-content">
                <!-- å‹•æ…‹ç”Ÿæˆæ—¥è¨˜å…§å®¹ -->
            </div>
        </section>
    </div>

    <!-- å°èˆªåˆ— -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-target="home">
            <span class="nav-icon">ğŸ </span>
            <span class="nav-label">é¦–é </span>
        </button>
        <button class="nav-item" data-target="practice">
            <span class="nav-icon">âœ¨</span>
            <span class="nav-label">ç·´ç¿’</span>
        </button>
        <button class="nav-item" data-target="journal">
            <span class="nav-icon">ğŸ“–</span>
            <span class="nav-label">æ—¥è¨˜</span>
        </button>
    </nav>

    <!-- å®Œæˆå‹•ç•« -->
    <div id="completion-modal" class="modal">
        <div class="modal-content celebration">
            <div class="confetti"></div>
            <span class="celebration-icon">ğŸ‰</span>
            <h3>å¤ªæ£’äº†ï¼</h3>
            <p id="completion-message">ä½ å®Œæˆäº†ä»Šå¤©çš„ç·´ç¿’ï¼</p>
            <p class="magic-words">æ„Ÿè¬ä½ ã€æ„Ÿè¬ä½ ã€æ„Ÿè¬ä½ </p>
            <button id="close-modal-btn" class="primary-btn">ç¹¼çºŒ</button>
        </div>
    </div>

    <script src="practices.js"></script>
    <script src="app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        // è¨»å†Š Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker è¨»å†ŠæˆåŠŸ:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker è¨»å†Šå¤±æ•—:', error);
                    });
            });
        }

        // å®‰è£æç¤º
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;

            // é¡¯ç¤ºå®‰è£æŒ‰éˆ•ï¼ˆå¦‚æœéœ€è¦ï¼‰
            const installBtn = document.getElementById('install-btn');
            if (installBtn) {
                installBtn.style.display = 'block';
                installBtn.addEventListener('click', () => {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('ç”¨æˆ¶æ¥å—å®‰è£');
                        }
                        deferredPrompt = null;
                    });
                });
            }
        });

        // æ¨æ’­é€šçŸ¥æ¬Šé™è«‹æ±‚
        async function requestNotificationPermission() {
            if ('Notification' in window && 'serviceWorker' in navigator) {
                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    console.log('é€šçŸ¥æ¬Šé™å·²æˆäºˆ');
                    scheduleReminders();
                }
            }
        }

        // è¨­å®šæ¯æ—¥æé†’
        function scheduleReminders() {
            // ä½¿ç”¨ localStorage è¨˜éŒ„æé†’è¨­å®š
            const reminderSet = localStorage.getItem('magicReminders');
            if (!reminderSet) {
                localStorage.setItem('magicReminders', 'true');
                console.log('å·²è¨­å®šæ¯æ—¥æé†’');
            }
        }
    </script>
</body>

</html>